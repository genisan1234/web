<!--
 Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 The Universal Permissive License (UPL), Version 1.0
 -->
<div class="oj-hybrid-padding">
  <oj-messages id="messagesId" messages="[[messagesDataprovider]]" display="notification" position="[[positionObject]]">
  </oj-messages>
  <h2>Employees</h2>
  <div class="oj-flex oj-sm-flex-items-initial">
    <div class="oj-flex-item">
      <oj-table id='table' class="banded-table" aria-controls="detailContainer" aria-label='Employees Table'
        first-selected-row="{{selectedRow}}" on-current-row-changed="[[rowChangeHandler]]"
        on-first-selected-row-changed="[[selectionChangedHandler]]" selection-mode='{"row": "single", "column": "none"}'
        data='[[dataProvider]]' columns-default.sortable='disabled' columns='[
        {"headerText": "Employee Number", "field": "empno"},
        {"headerText": "Username", "field": "ename"},
        {"headerText": "Title", "field": "job", "template": "titleTemplate"},
        {"headerText": "Hire Date", "field": "hiredate", "template": "hireDateTemplate"}, 
        {"headerText": "Salary", "field": "sal", "template": "salaryTemplate"},
        {"headerText": "Action", "field": "empno", "template": "editTemplate"}]'>
        <template slot="titleTemplate" data-oj-as="title">
          <oj-bind-text value="[[title.data]]"></oj-bind-text>
        </template>
        <template slot="hireDateTemplate" data-oj-as="hireDate">
          <oj-bind-text value="[[formatDate(hireDate.data)]]"></oj-bind-text>
        </template>
        <template slot="salaryTemplate" data-oj-as="salary">
          <oj-bind-text value="[[formatSal(salary.data)]]"></oj-bind-text>
        </template>
        <template slot="editTemplate" data-oj-as="edit">
          <oj-button :id="[[edit.data + '-btn']]" disabled="{{isDisabled}}" on-oj-action="[[editRow]]">Edit</oj-button>
        </template>
      </oj-table>
    </div>

    <!-- employee details panel -->
    <div id="detailContainer" class="oj-flex-item" style="margin-left: 30px; min-width: 200px">
      <h3>
        <oj-label>Employee Details</oj-label>
      </h3>
      <hr style="margin-top:12px;">
      <oj-bind-if test="[[!activeRow()]]">
        <span>Activate a row in the employees table to see details</span>
      </oj-bind-if>
      <oj-bind-if test="[[activeRow()]]">
        <div aria-live="polite">
          <oj-avatar :aria-lable="[['avatar image for ' + detailEmployeeName() ]]"
            src="[['css/images/' + detailEmployeeId() + '.png']]" style="float:right;">
          </oj-avatar>
          <div id="employeeName" style="font-size: 20px; font-weight: bolder;">
            <oj-bind-text value="[[detailEmployeeName()]]"></oj-bind-text>
          </div>
          <div id="departmentName" style="font-size: 14px; font-weight: 400; font-style:italic; margin-bottom: 10px;">
            <oj-bind-text value="[[detailDeptNo()]]"></oj-bind-text>
          </div>
          <div id="employeeSalary">
            <oj-bind-text value="[['Salary: ' + detailSal()]]"></oj-bind-text>
          </div>
          <div id="employeeManager">
            <oj-bind-text value="[['Manager: ' + detailMgr()]]"></oj-bind-text>
          </div>
        </div>
      </oj-bind-if>
    </div>

  </div>


  <!-- Edit dialog -->
  <oj-dialog style="display:none" id="editDialog" dialog-title="Edit Employee">
    <div slot="body">
      <oj-validation-group valid="{{groupValid}}">
        <div class="oj-flex oj-flex-items-pad">
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-label for="employeeIdEdit">Employee Id</oj-label>
          </div>
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-input-number id="employeeIdEdit" readonly="true" min="0" step="1" value="{{editEmployeeId}}">
            </oj-input-number>
          </div>
        </div>
        <div class="oj-flex oj-flex-items-pad">
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-label for="employeeNameEdit">Employee Name</oj-label>
          </div>
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-input-text id="employeeNameEdit" value="{{editEmployeeName}}"></oj-input-text>
          </div>
        </div>
        <div class="oj-flex oj-flex-items-pad">
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-label for="jobEdit">Job Title</oj-label>
          </div>
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-input-text id="jobEdit" length.max="9" value="{{editJob}}"></oj-input-text>
          </div>
        </div>
        <div class="oj-flex oj-flex-items-pad">
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-label for="hireDate">Hire Date</oj-label>
          </div>
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-input-text id="hireDate" readonly="true" value="{{formatDate(editHireDate())}}"></oj-input-text>
          </div>
        </div>
        <div class="oj-flex oj-flex-items-pad">
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-label for="salaryEdit">Salary</oj-label>
          </div>
          <div class="oj-flex-item deprecated-col-default-width">
            <oj-input-number id="salaryEdit" min="0" step="1" value="{{editSal}}">
            </oj-input-number>
          </div>
        </div>
      </oj-validation-group>
    </div>
    <div slot="footer">
      <oj-button id="saveButton" on-oj-action="[[save]]">Save
      </oj-button>
      <oj-button id="cancelButton" on-oj-action="[[cancel]]">Cancel
      </oj-button>
    </div>
  </oj-dialog>
</div>